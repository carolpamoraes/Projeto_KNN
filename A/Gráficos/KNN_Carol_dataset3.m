clc
clear all
close all

%Teste KNN
%Inicialização
k=5;
n=0;
m=0;
M_saudavel=zeros(2,3);
M_doente=zeros(2,4);

%Quantidade de dados
quant_training=150;
quant_teste=50;

%Dados Treinamento
y=[0.115551000000000;-1.34234000000000;4.30436200000000;2.13579100000000;-5.06521700000000;-4.92066900000000;1.34854600000000;-0.905019000000000;0.411483000000000;0.340136000000000;2.28375800000000;4.07051400000000;-0.877021000000000;-1.35155400000000;-1.18689900000000;3.47894000000000;0.476784000000000;-2.26731000000000;-6.13548200000000;-2.37181300000000;-4.22671700000000;1.88713500000000;0.624759000000000;-2.48619900000000;0.293026000000000;3.86733600000000;-0.898022000000000;1.76027600000000;1.07296300000000;4.53079000000000;7.78950300000000;1.16899800000000;-1.62688500000000;0.427278000000000;4.03507100000000;-2.81884500000000;-3.57706700000000;-0.973866000000000;2.05373200000000;1.84713500000000;0.744926000000000;0.572995000000000;-3.81771900000000;0.648971000000000;1.33216100000000;-0.571459000000000;-2.18156400000000;-0.360524000000000;-1.14944300000000;-2.65274500000000;0.0274180000000000;3.51787500000000;-2.80214800000000;3.79088600000000;0.224157000000000;-6.24370500000000;9.33084700000000;-3.64090000000000;-2.10210500000000;-2.44592400000000;3.02760800000000;-1.66611300000000;5.63194300000000;6.67144400000000;-5.85224400000000;1.21310900000000;1.06055600000000;0.284082000000000;0.128109000000000;-1.20074000000000;0.632940000000000;0.865013000000000;0.0805500000000000;0.178809000000000;-0.226284000000000;-0.908586000000000;1.26528600000000;-0.172504000000000;0.183164000000000;-2.10314300000000;1.59302200000000;-0.239727000000000;-0.668096000000000;-0.954007000000000;-0.963089000000000;-1.24925200000000;-0.478661000000000;-0.541546000000000;0.560895000000000;0.667392000000000;1.32967500000000;-1.46672700000000;0.657065000000000;0.101279000000000;-0.959984000000000;2.22544600000000;1.08948200000000;-1.11330700000000;0.0871830000000000;0.844199000000000;1.61992200000000;0.0424890000000000;0.0788070000000000;-0.498907000000000;-0.0785450000000000;-0.662633000000000;0.0228160000000000;-1.07723400000000;1.77418100000000;0.215789000000000;-0.0155520000000000;1.45774700000000;1.31062700000000;0.633882000000000;-0.539257000000000;0.633342000000000;-0.467699000000000;-0.220041000000000;0.455318000000000;1.96351500000000;0.292495000000000;0.280751000000000;0.224041000000000;-0.0699840000000000;-0.294920000000000;0.629408000000000;-0.655216000000000;-1.06034100000000;1.59038500000000;-0.573740000000000;2.75520700000000;5.73559600000000;4.94197000000000;3.94153900000000;-0.440697000000000;0.0595730000000000;-4.94357800000000;7.53063300000000;-6.92964100000000;2.73994900000000;-0.308117000000000;-2.17885000000000;-0.830930000000000;-3.92798100000000;0.00234600000000000;-4.66204400000000;3.07759200000000;-3.39666200000000;4.30288500000000;3.87462600000000];
x=[2.15888100000000;-3.71692700000000;1.73667300000000;0.138084000000000;5.16025200000000;3.58497000000000;-0.616419000000000;-2.91399400000000;0.886557000000000;-0.383436000000000;-3.43278700000000;2.41170300000000;1.86816100000000;-2.21108800000000;1.53915900000000;-1.89526200000000;-9.10820400000000;-0.105675000000000;-3.60947500000000;4.84871800000000;0.165014000000000;1.02464700000000;-1.31684300000000;1.54509600000000;-2.72977900000000;0.980072000000000;2.19278700000000;-5.74598100000000;-0.229524000000000;0.731329000000000;-1.60075200000000;0.318599000000000;2.28827700000000;0.707095000000000;3.50938500000000;0.928738000000000;0.517149000000000;-5.35796100000000;2.55636300000000;-5.09579700000000;0.0611240000000000;-1.81394900000000;4.02346100000000;-1.55898100000000;2.97705300000000;0.103109000000000;-1.81710300000000;4.07252000000000;0.163363000000000;-1.48888600000000;-1.89194200000000;1.26876600000000;4.71807800000000;0.147193000000000;2.64177900000000;0.852305000000000;-2.61063100000000;2.69636900000000;-1.69648700000000;2.31089800000000;4.46771200000000;-0.474103000000000;-3.65550300000000;4.85390700000000;0.233218000000000;0.0838370000000000;-0.935894000000000;0.260132000000000;-0.253203000000000;0.359806000000000;-0.330794000000000;-1.74553400000000;-0.647244000000000;0.412435000000000;2.03963300000000;-2.12492000000000;1.55104900000000;-0.715853000000000;0.732836000000000;-0.911091000000000;-1.28057700000000;0.760710000000000;0.321735000000000;-0.866069000000000;-0.236375000000000;0.486466000000000;0.248420000000000;-0.653896000000000;0.0864430000000000;0.177508000000000;-2.13480200000000;1.71398500000000;-0.403092000000000;0.496645000000000;-0.511053000000000;-1.81764200000000;-0.300778000000000;0.0657820000000000;1.59163800000000;-0.718371000000000;0.641909000000000;-1.04145600000000;0.0139430000000000;2.55140000000000;-0.540839000000000;-0.948464000000000;1.55285500000000;0.869526000000000;0.372589000000000;0.111065000000000;-0.0658150000000000;0.300897000000000;0.633784000000000;0.101697000000000;-0.679504000000000;-0.515300000000000;0.482627000000000;-0.0692740000000000;-0.993321000000000;0.171734000000000;-0.378782000000000;0.860383000000000;0.00994600000000000;0.782352000000000;0.0356970000000000;0.481114000000000;0.662065000000000;-0.707306000000000;1.10428300000000;1.47303200000000;3.19269600000000;-1.52096500000000;0.254661000000000;-3.13736100000000;0.0681560000000000;-8.02016700000000;4.75150100000000;-1.26647200000000;-0.311506000000000;-0.410387000000000;-1.00828600000000;-2.08402800000000;-1.04922100000000;-0.524612000000000;4.97982000000000;-8.13695000000000;2.21203300000000;5.36102900000000;2.21414500000000;0.593695000000000];
Teta=[1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1];

%Dados Treinamento em MATRIZ
d_training=[y x];



for it=1:quant_training
    
    if Teta(it,1)==2
        
        n=n+1;

        M_saudavel(:,n)=[x(it,1),y(it,1)];       

    else
        
        m=m+1;

        M_doente(:,m)=[x(it,1),y(it,1)]; 

    end
    
end

%Grafico Treinamento
figure(1)
scatter(M_saudavel(1,:),M_saudavel(2,:),'o','blue');
hold on
scatter(M_doente(1,:),M_doente(2,:),'^','green');
hold off


%Dados teste
y_t=[1.23139800000000;6.26397600000000;0.195714000000000;-0.323162000000000;5.20475300000000;4.92738200000000;-1.04971600000000;0.593480000000000;-6.50075800000000;2.30434300000000;-0.965065000000000;-2.53871900000000;-0.755207000000000;-4.45093000000000;2.49940100000000;0.321121000000000;-0.436883000000000;1.61993800000000;-0.820813000000000;0.398094000000000;-0.885689000000000;-0.762732000000000;-0.610703000000000;-0.316767000000000;0.836389000000000;-0.279447000000000;-1.04661200000000;0.0136560000000000;-0.0541040000000000;0.573238000000000;-0.414579000000000;-1.38289700000000;1.32033400000000;-0.405387000000000;0.676432000000000;-0.245269000000000;-1.18828200000000;0.0159430000000000;-0.693386000000000;2.22070600000000;-1.64844200000000;0.269841000000000;2.21339800000000;-1.43526900000000;0.921800000000000;-0.342304000000000;-1.40592200000000;1.14141400000000;-0.796062000000000;-1.07203500000000];
x_t=[0.429449000000000;-1.18240800000000;0.0482480000000000;-2.79792400000000;1.71567400000000;0.242508000000000;3.66194500000000;0.438952000000000;1.40461500000000;1.01439800000000;-1.25643600000000;1.18858900000000;3.17619400000000;1.71345500000000;1.55318000000000;0.175208000000000;0.632669000000000;-1.09016100000000;-0.300827000000000;2.04174500000000;-0.0939070000000000;-0.479265000000000;1.02562200000000;1.47907800000000;-0.664728000000000;0.0523550000000000;-1.27682300000000;-0.0461510000000000;1.03811200000000;0.299304000000000;-1.31591600000000;0.130689000000000;0.0661190000000000;0.451215000000000;0.315846000000000;0.723702000000000;1.44135300000000;0.447233000000000;0.608593000000000;-0.468723000000000;-0.834600000000000;0.0329540000000000;-0.962430000000000;0.606950000000000;0.529722000000000;0.139828000000000;0.450007000000000;-0.580642000000000;1.94939300000000;-0.456013000000000];
Teta_t=[1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2];

%Dados teste em MATRIZ
d_test=[y_t x_t];

%Contadores de acerto e erro
acerto=0;
erro=0;

for iy=1:quant_teste
    
    for ix=1:quant_training
        
        d(:,ix)=norm(d_test(iy,:)-d_training(ix,:));
        
    end
    
     cont_d=0;
 cont_s=0;

[l,c]=sort(d);

for ik=1:k

    a = Teta(c(1,ik),1);
    
    if a==1
        
        cont_d=cont_d+1;
        
    else
        
        cont_s=cont_s+1;
        
    end
    
    
end


    %Quantidade de acertos
    if a==Teta_t(iy,1)
        
        acerto=acerto+1;
        
    else 
        
        erro=erro+1;        
        
    end
    
    
    %Grafico Teste
    figure(2)
    scatter(M_doente(1,:),M_doente(2,:),'+','red');    
    hold on
    scatter(M_saudavel(1,:),M_saudavel(2,:),'.','blue');
    hold on

    if cont_d > cont_s

    disp('Classificação: 1');
    scatter(d_test(iy,2),d_test(iy,1),'^','red');
    hold on

    else 

    disp('Classificação: 2');
    scatter(d_test(iy,2),d_test(iy,1),'o','blue');
    hold on

    end
    
end


    
%Acurácia
Ac=(acerto/quant_teste)*100;
X = ['Acurácia: ',num2str(Ac),'%'];
disp(X);
    
    
    
 