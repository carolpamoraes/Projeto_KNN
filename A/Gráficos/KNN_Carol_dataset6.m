clc
clear all
close all

%Teste KNN
%Inicialização
k=3;
n=0;
m=0;
p=0;
Classe_1=zeros(2,3);
Classe_2=zeros(2,4);
Classe_3=zeros(2,4);

%Quantidade de dados
quant_training=110;
quant_teste=40;

%Dados Treinamento
y=[1.80361900000000;1.93778700000000;1.02136100000000;1.37471900000000;1.22155100000000;1.98838200000000;-0.0272770000000000;-1.16777700000000;1.45208600000000;1.18657000000000;0.750651000000000;0.606622000000000;-0.511925000000000;1.26173100000000;-0.275956000000000;0.717623000000000;1.37555100000000;1.01982700000000;0.904575000000000;0.00554800000000000;2.57851800000000;1.15152400000000;1.11447600000000;-0.313654000000000;0.683968000000000;2.69637200000000;-0.548394000000000;1.43158200000000;-1.07679500000000;2.17821500000000;-1.30801200000000;-0.610279000000000;0.906133000000000;-0.986699000000000;-0.967302000000000;1.48824500000000;-2.02241900000000;-2.05855400000000;-1.93538500000000;0.156567000000000;-0.164586000000000;-1.73365500000000;-1.30943400000000;-2.70723700000000;-0.567512000000000;-1.80348500000000;0.728923000000000;-2.10478900000000;-2.94856300000000;-0.521472000000000;-3.27621200000000;-1.82252300000000;-0.535422000000000;-1.53357200000000;0.195757000000000;1.96213400000000;0.437109000000000;-0.320132000000000;-0.403618000000000;-0.229484000000000;-1.90402900000000;0.0468570000000000;-0.374641000000000;-0.197422000000000;0.598301000000000;-0.633773000000000;-2.20219500000000;-0.704551000000000;-1.62160900000000;-2.30433900000000;-0.953613000000000;-2.47981800000000;0.612420000000000;-1.36662900000000;-1.62111500000000;-0.101153000000000;-2.33138900000000;0.936548000000000;-0.945095000000000;-1.82810900000000;-2.12161700000000;-1.56939400000000;-0.744951000000000;-2.48872700000000;-0.582608000000000;-0.966725000000000;-0.768412000000000;1.00840200000000;-1.91362300000000;-2.18482200000000;0.584378000000000;2.55560500000000;1.06886300000000;1.30556900000000;1.90107500000000;2.20172000000000;-0.330867000000000;1.95210300000000;0.676064000000000;1.44416500000000;-0.832075000000000;2.10056700000000;2.05058700000000;1.80076800000000;2.03497000000000;0.447737000000000;0.968173000000000;-0.622648000000000;1.07308400000000;0.432768000000000];
x=[1.57392200000000;2.48007500000000;-1.11118900000000;1.81415000000000;0.0448420000000000;1.82211500000000;1.24182100000000;0.932322000000000;0.0631630000000000;1.20547100000000;0.351459000000000;1.33332000000000;1.35194000000000;0.0982270000000000;0.537278000000000;2.28702700000000;0.664512000000000;2.44494500000000;0.0493210000000000;1.45417000000000;0.766114000000000;-0.374268000000000;2.68958800000000;0.444772000000000;2.73557100000000;0.116033000000000;0.533329000000000;0.876357000000000;1.29058300000000;2.86029200000000;-0.954686000000000;-1.03279600000000;-0.217539000000000;0.142387000000000;0.0916110000000000;-0.269760000000000;-1.45682500000000;0.702722000000000;-0.861953000000000;-0.820044000000000;-0.991029000000000;-0.336558000000000;-0.0962990000000000;-0.820960000000000;0.730318000000000;-1.45657100000000;-1.00912100000000;-1.30342200000000;-2.18068700000000;-2.21382400000000;-0.484028000000000;-1.84800400000000;-0.426156000000000;-1.44208100000000;-0.686051000000000;-1.15156100000000;-0.243752000000000;0.513597000000000;0.624710000000000;-1.34053900000000;3.13907100000000;1.82734000000000;1.03530300000000;1.89079000000000;1.46253000000000;2.19874000000000;1.36698600000000;2.51333300000000;-0.0291550000000000;4.39851500000000;3.28968600000000;0.859656000000000;2.80617900000000;2.26547600000000;4.07386100000000;2.09247800000000;1.09169000000000;0.996191000000000;1.54935000000000;2.37298700000000;1.79282800000000;1.96469500000000;1.03324200000000;2.06718800000000;1.00728600000000;2.15319600000000;0.946864000000000;3.55032800000000;3.83625600000000;3.24167000000000;0.591686000000000;2.77932800000000;1.49330100000000;0.469889000000000;0.497227000000000;0.653685000000000;1.60079000000000;1.60644500000000;0.710189000000000;2.52518600000000;0.983842000000000;2.28579800000000;0.708875000000000;2.64697300000000;0.535522000000000;1.55530900000000;2.16603000000000;0.808764000000000;-0.200354000000000;1.28649300000000];
Teta_training=[1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1];

%Dados Treinamento em MATRIZ
d_training=[y x];



for it=1:quant_training
    
    if Teta_training(it,1)==1
        
        n=n+1;

        Classe_1(:,n)=[x(it,1),y(it,1)];      
        
    elseif  Teta_training(it,1)==2    
        
        m=m+1;

        Classe_2(:,m)=[x(it,1),y(it,1)]; 

    else
        
        p=p+1;

        Classe_3(:,p)=[x(it,1),y(it,1)]; 

    end
    
end

%Grafico Treinamento
figure(1)
scatter(Classe_1(1,:),Classe_1(2,:),'^','red');
hold on
scatter(Classe_2(1,:),Classe_2(2,:),'o','blue');
hold on
scatter(Classe_3(1,:),Classe_3(2,:),'d','green');
hold off


%Dados teste
y_t=[-0.155864000000000;-0.654091000000000;0.0951030000000000;-0.937409000000000;-0.237923000000000;-1.31827900000000;-0.775808000000000;-1.71163100000000;-1.26354900000000;-1.90059600000000;1.32739300000000;-0.0426870000000000;-0.984103000000000;-1.39776600000000;-0.670068000000000;-1.88919200000000;-0.628105000000000;-0.707158000000000;-3.40323900000000;-2.81245000000000;-1.76290000000000;-2.63963000000000;-1.84682100000000;-0.346738000000000;-0.654748000000000;-0.659320000000000;-3.07454400000000;-1.28845400000000;-1.34572500000000;-0.213576000000000;-1.98582400000000;-0.593772000000000;-1.00250100000000;-0.770422000000000;0.499938000000000;0.00788300000000000;-0.453994000000000;0.792974000000000;-1.09302900000000;-1.60343100000000];
x_t=[0.100894000000000;-0.705156000000000;1.01772200000000;-2.65916200000000;0.700559000000000;-2.40703700000000;0.123346000000000;-1.27203800000000;-0.791834000000000;-0.236042000000000;-1.96437000000000;-0.731883000000000;-3.16114500000000;1.19368800000000;-1.51994000000000;-0.184603000000000;0.318356000000000;-2.71718100000000;0.853446000000000;-0.303742000000000;2.81542100000000;2.84066100000000;2.37047100000000;0.308358000000000;2.64363100000000;3.27400000000000;3.16916600000000;1.86511100000000;1.00029100000000;3.10598000000000;2.52310600000000;2.20240900000000;2.11905100000000;1.39256800000000;2.05811300000000;2.43463900000000;1.31338500000000;2.97942300000000;3.83881600000000;1.94359400000000];
Teta_t=[2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3];

%Dados teste em MATRIZ
d_test=[y_t x_t];

%Contadores de acerto e erro
acerto=0;
erro=0;


for iy=1:quant_teste
    
    for ix=1:quant_training
        
        d(:,ix)=norm(d_test(iy,:)-d_training(ix,:));
        
    end
    
     cont_1=0;
     cont_2=0;
     cont_3=0;

[l,c]=sort(d);

    for ik=1:k

        a = Teta_training(c(1,ik),1);

        if a==1

            cont_1=cont_1+1;

        elseif a==2

            cont_2=cont_2+1;

        else

            cont_3=cont_3+1;

        end


    end
    
    
        %Quantidade de acertos
        if a==Teta_t(iy,1)

            acerto=acerto+1;

        else 

            erro=erro+1;        

        end
        
        
        %Grafico Teste
        figure(2)
        scatter(Classe_1(1,:),Classe_1(2,:),'*','red');    
        hold on
        scatter(Classe_2(1,:),Classe_2(2,:),'.','blue');
        hold on
        scatter(Classe_3(1,:),Classe_3(2,:),'+','green');
        hold on

        if cont_1 > cont_2 && cont_1 > cont_3

        disp('Classificação: 1');
        scatter(d_test(iy,2),d_test(iy,1),'^','red');
        hold on

        elseif  cont_2 > cont_1 && cont_2 > cont_3

        disp('Classificação: 2');
        scatter(d_test(iy,2),d_test(iy,1),'o','blue');
        hold on

        else

        disp('Classificação: 3');
        scatter(d_test(iy,2),d_test(iy,1),'d','green');
        hold on   

        end
    
end



%Acurácia
Ac=(acerto/quant_teste)*100;
X = ['Acurácia: ',num2str(Ac),'%'];
disp(X); 


    

    
    
    
 