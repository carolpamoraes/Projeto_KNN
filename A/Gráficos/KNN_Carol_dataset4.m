clc
clear all
close all

%Teste KNN
%Inicialização
k=3;
n=0;
m=0;
M_saudavel=zeros(2,3);
M_doente=zeros(2,4);

%Quantidade de dados
quant_training=90;
quant_teste=40;

%Dados Treinamento
y=[-4.08756300000000;0.958639000000000;-5.76025900000000;-0.284436000000000;-3.07241100000000;-3.78164000000000;-0.166774000000000;-0.481410000000000;0.231876000000000;1.35613700000000;-1.08050700000000;-0.179767000000000;0.741916000000000;1.39814900000000;0.242245000000000;2.87944800000000;-1.79544600000000;5.15445200000000;1.57523900000000;1.90322100000000;-2.20992600000000;1.89244300000000;-1.41299500000000;-1.96540500000000;0.461644000000000;-2.77630100000000;1.50187000000000;3.46404500000000;-2.84159000000000;0.171207000000000;0.580806000000000;-0.772948000000000;0.236926000000000;-1.13445100000000;-0.806783000000000;1.53491100000000;1.82322200000000;-4.81996000000000;0.486534000000000;-1.48867900000000;-0.00441700000000000;-7.40315600000000;1.46393100000000;-2.70435400000000;-0.608269000000000;2.95955300000000;0.496120000000000;0.830986000000000;1.33616700000000;-1.06850700000000;0.0692590000000000;0.894241000000000;-2.39297900000000;0.0370110000000000;-1.48253600000000;-1.52291900000000;-1.93708600000000;-2.52296700000000;0.340363000000000;6.46791600000000;1.62241300000000;2.32909600000000;3.05703400000000;-3.38691300000000;3.45023000000000;0.353090000000000;-0.864277000000000;-0.913667000000000;3.95263000000000;0.584949000000000;2.80122100000000;1.93016200000000;-0.590970000000000;-2.34558700000000;7.57796300000000;-1.84015300000000;1.78303500000000;-0.622056000000000;0.375657000000000;1.55836100000000;-0.185647000000000;-4.05312000000000;-0.963392000000000;6.11661600000000;-3.17298600000000;-6.94655100000000;2.94878600000000;-0.966110000000000;2.50147800000000;3.12886600000000];
x=[-2.56086300000000;5.88447900000000;-2.47149100000000;-1.85218100000000;-2.39780800000000;-0.583072000000000;-0.0148990000000000;-2.74950200000000;1.99263200000000;0.328208000000000;0.444152000000000;-3.47309300000000;-0.490929000000000;0.532222000000000;-4.30563200000000;3.52140000000000;1.64890100000000;-4.39829300000000;-4.26280000000000;-0.914260000000000;4.56510100000000;-1.53386300000000;3.22531400000000;-1.92562700000000;-1.18779500000000;4.98171300000000;-0.952924000000000;2.33873500000000;0.981630000000000;-0.541739000000000;-0.321770000000000;1.84176900000000;1.40435500000000;-0.118622000000000;0.207728000000000;-0.989696000000000;7.35809200000000;-0.436897000000000;-0.372604000000000;1.33901500000000;-1.60718100000000;1.24697800000000;3.34130900000000;0.120203000000000;-2.67157400000000;-1.46099400000000;-1.90135800000000;1.58926600000000;-0.715376000000000;-2.33158100000000;0.279985000000000;-1.61333300000000;-1.65977400000000;1.24542200000000;-0.242535000000000;-0.723673000000000;-2.65924300000000;-1.30470100000000;-1.50281600000000;-1.84231100000000;-4.94799700000000;4.97576600000000;-7.82275200000000;4.99300900000000;-7.28300100000000;1.19231000000000;-4.31807200000000;2.93149700000000;1.46067300000000;-0.842590000000000;1.11781700000000;-3.69585800000000;-0.525126000000000;-2.88198300000000;-2.24070400000000;-0.228990000000000;0.570238000000000;-1.63547700000000;1.26860700000000;3.44432500000000;4.74458100000000;4.84156300000000;0.478287000000000;-0.524066000000000;2.08792800000000;2.85883100000000;-4.23329100000000;1.82566500000000;-3.38257900000000;-3.79898800000000];
Teta_training=[1;1;1;1;1;1;1;1;1;1;2;2;2;2;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;2;2;2;2;2;2;1;1;1;1;1;1;1;1;1;1;1;2;2;2;2;2;2;2;2;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;2;2;2;2;1;1;1;1;1;1;1;1;1;1;1];


%Dados Treinamento em MATRIZ
d_training=[y x];



for it=1:quant_training
    
    if Teta_training(it,1)==2
        
        n=n+1;

        M_saudavel(:,n)=[x(it,1),y(it,1)];       

    else
        
        m=m+1;

        M_doente(:,m)=[x(it,1),y(it,1)]; 

    end
    
end

%Grafico Treinamento
figure(1)
scatter(M_saudavel(1,:),M_saudavel(2,:),'o','blue');
hold on
scatter(M_doente(1,:),M_doente(2,:),'^','green');
hold off


%Dados teste
y_t=[1.59101100000000;-3.97694100000000;1.06077100000000;0.154769000000000;-0.311781000000000;-2.67041100000000;3.30914500000000;2.46938100000000;-0.316588000000000;1.59885800000000;-0.553956000000000;-2.02945800000000;0.0471440000000000;3.45134100000000;-0.341242000000000;-0.701303000000000;-4.49091700000000;2.22780100000000;-0.436825000000000;1.35106100000000;0.990065000000000;-1.16988900000000;-3.36636100000000;1.75002200000000;2.23958200000000;-2.36474300000000;-0.971950000000000;-3.99485200000000;-0.211920000000000;-2.75399600000000;0.525724000000000;-0.920000000000000;-0.0373180000000000;0.474841000000000;-3.68186600000000;2.82388600000000;-3.81739100000000;-1.38050400000000;-0.307199000000000;0.814984000000000];
x_t=[-3.01862300000000;4.90209000000000;-5.03751200000000;1.74208500000000;-6.11033500000000;-4.83416000000000;-3.46556600000000;0.326621000000000;1.24510200000000;1.24802500000000;-0.922018000000000;2.18727600000000;-2.89830000000000;3.00121500000000;3.97822700000000;4.93112200000000;2.50043700000000;-3.49724800000000;-0.747791000000000;1.59661000000000;-0.309554000000000;0.889251000000000;-0.741648000000000;3.32993600000000;2.52827700000000;2.34784700000000;-1.47317800000000;4.63872300000000;0.367620000000000;2.73666500000000;2.82551600000000;0.434239000000000;-0.982851000000000;1.02925300000000;2.05865200000000;2.69324100000000;0.506600000000000;-3.43048300000000;-5.37459400000000;0.375275000000000];
Teta_t=[1;1;1;1;1;1;1;1;2;2;2;1;1;1;1;1;1;1;2;2;2;1;1;1;1;1;1;1;1;1;1;1;2;2;1;1;1;1;1;1];


%Dados teste em MATRIZ
d_test=[y_t x_t];

%Contadores de acerto e erro
acerto=0;
erro=0;


for iy=1:quant_teste
    
    for ix=1:quant_training
        
        d(:,ix)=norm(d_test(iy,:)-d_training(ix,:));
        
    end
    
     cont_d=0;
 cont_s=0;

[l,c]=sort(d);

for ik=1:k

    a = Teta_training(c(1,ik),1);
    
    if a==1
        
        cont_d=cont_d+1;
        
    else
        
        cont_s=cont_s+1;
        
    end
    
    
end


    %Quantidade de acertos
    if a==Teta_t(iy,1)
        
        acerto=acerto+1;
        
    else 
        
        erro=erro+1;        
        
    end
    
    
    %Grafico Teste
    figure(2)
    scatter(M_doente(1,:),M_doente(2,:),'+','red');    
    hold on
    scatter(M_saudavel(1,:),M_saudavel(2,:),'.','blue');
    hold on

    if cont_d > cont_s

    disp('Classificação: 1');
    scatter(d_test(iy,2),d_test(iy,1),'^','red');
    hold on

    else 

    disp('Classificação: 2');
    scatter(d_test(iy,2),d_test(iy,1),'o','blue');
    hold on

    end
    
end


%Acurácia
Ac=(acerto/quant_teste)*100;
X = ['Acurácia: ',num2str(Ac),'%'];
disp(X);    

    
    
    
 